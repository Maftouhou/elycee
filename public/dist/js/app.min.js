"use strict";angular.module("elycee",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","LocalStorageModule"]).config(function(e,t){e.when("/",{templateUrl:"../app/views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/articles/:id",{templateUrl:"../app/views/single.html",controller:"SingleCtrl",controllerAs:"single"}).when("/about",{templateUrl:"../app/views/about.html",controller:"AboutCtrl",controllerAs:"about"}).when("/contact",{templateUrl:"../app/views/contact.html",controller:"ContactCtrl",controllerAs:"contact"}).when("/login",{templateUrl:"../app/views/login.html",controller:"LoginCtrl",controllerAs:"login"}).when("/search",{templateUrl:"../app/views/search.html",controller:"SearchCtrl",controllerAs:"search"}).when("/actus",{templateUrl:"../app/views/actus.html",controller:"ActusCtrl",controllerAs:"actus"}).when("/dashboard",{templateUrl:"../app/views/dashboard.html",controller:"DashboardCtrl",controllerAs:"dashboard"}).otherwise({redirectTo:"/"}),t.setStorageType("cookies")}).animation(".transition",function(){return{enter:function(e,t){TweenMax.from(e,1,{opacity:1,onComplete:t},0)},leave:function(e,t){TweenMax.to(e,1,{opacity:0,onComplete:t},0)}}}).directive("back",function(){return{restrict:"A",link:function(e,t,o){t.bind("click",function(){history.back(),e.$apply()})}}}).factory("userService",function(e,t){function o(){return!!t.get("XSRF-TOKEN","cookies")}function a(o,a,l,n){console.log(t),e.post("api/login",{username:o,password:a}).then(function(e){console.log(e),t.set("XSRF-TOKEN",e.data.token),l(e)},function(e){n(e)})}function l(){t.remove("XSRF-TOKEN","cookies")}function n(){return t.get("XSRF-TOKEN","cookies")}return{checkIfLoggedIn:o,login:a,logout:l,getCurrentToken:n}}).factory("contactService",function(e){return{save:function(t,o,a,l,n){return console.log(t,o,a,l,n),e({method:"POST",url:"/send",data:{nom:t,prenom:o,email:a,title:l,content:n}})}}}).factory("commentService",function(e){return{get:function(){return e.get("api/articles/")},save:function(t,o,a,l){return console.log(t,o,a,l),e({method:"POST",url:"/comments",data:{content:t,post_id:o,status:a,title:l}})}}});const tl=new TimelineMax({paused:!0,completed:!0});tl.to("header ul li a",1,{opacity:1},0),tl.restart(),angular.module("elycee").controller("AboutCtrl",function(e,t,o){t.get("api/articles").success(function(t){e.posts=t}),e.val=function(){o.id=this.post.id},e.show=function(){$(".col_left .row").html('<div class="el" style="background-image:url(\'/uploads/images/'+this.post.url_thumbnail+"')\"></div>"),TweenLite.from(".col_left .row",1,{opacity:0,scale:1.1,ease:Expo.easeOut}),TweenLite.to(".col_left .row",1,{opacity:1,scale:1,ease:Expo.easeOut}),TweenLite.to(".col_left .new",1,{opacity:0,scale:1,ease:Expo.easeOut})},e.hide=function(){TweenLite.to(".col_left .row",1,{opacity:0,scale:1,ease:Expo.easeOut}),TweenLite.from(".col_left .new",1,{opacity:0,scale:1.1,ease:Expo.easeOut}),TweenLite.to(".col_left .new",1,{opacity:1,scale:1,ease:Expo.easeOut})};const a=new TimelineMax({paused:!0,completed:!0});a.to(".col_right",1.7,{right:"0%",ease:Expo.easeOut},0),a.from(".info",1,{opacity:0,x:"10%",ease:Expo.easeOut},1.8),a.from(".row",1,{opacity:0,x:"10%",ease:Expo.easeOut},2),a.staggerTo(".row a",3.7,{opacity:0,scale:1.2},1,2),a.from(".col_left .new",1.7,{opacity:0,scale:1.2},2.2),a.from(".col_left h1",1,{opacity:0,x:"-10%",ease:Expo.easeOut},3.8),a.from(".col_left .mask",1,{opacity:0,x:"-10%",ease:Expo.easeOut},4),a.restart()}),angular.module("elycee").controller("ActusCtrl",function(e,t,o){var a=o.search;t.get("search?exp="+a).success(function(t){e.posts=t.data}),e.val=function(){o.id=this.post.id},e.show=function(){$(".big-title h1").html(this.post.title),TweenLite.from(".big-title h1",1,{opacity:0,y:"100%",ease:Expo.easeOut}),TweenLite.to(".big-title h1",1,{opacity:1,y:"0%",ease:Expo.easeOut})},e.hide=function(){TweenLite.to(".big-title h1",1,{opacity:0,y:"100%",ease:Quart.easeOut})};const l=new TimelineMax({paused:!0,completed:!0});l.to(".col_right",1.7,{right:"0%",ease:Expo.easeOut},0),l.from(".info",1,{opacity:0,x:"10%",ease:Expo.easeOut},1.8),l.from(".row",1,{opacity:0,x:"10%",ease:Expo.easeOut},2),l.staggerTo(".row a",3.7,{opacity:0,scale:1.2},1,2),l.restart()}),angular.module("elycee").controller("ContactCtrl",function(e,t,o,a){e.submitContact=function(){o.save(e.firstname,e.lastname,e.email,e.title,e.content).success(function(e){}).error(function(e){console.log("error ")})};const l=new TimelineMax({paused:!0,completed:!0});l.from(".bg",1.7,{x:"100%",ease:Expo.easeOut},0),l.from(".row",1.7,{x:"100%",opacity:0,ease:Expo.easeOut},.2),l.restart()}),angular.module("elycee").controller("DashboardCtrl",["$scope","$http","$location","userService",function(e,t,o,a){e.out=function(){a.logout(),o.path("api/logout")};const l=new TimelineMax({paused:!0,completed:!0});l.to(".collapse",1.7,{left:"0%",ease:Expo.easeOut},0),l.staggerFrom(".collapse ul li a",1.2,{left:"-100%",opacity:0,ease:Expo.easeOut},.2,.8),l.staggerFrom(".panel.panel-default",1.2,{y:"100%",opacity:0,ease:Expo.easeOut},.2,.8),l.restart()}]),angular.module("elycee").controller("LoginCtrl",["$scope","$http","$location","userService",function(e,t,o,a){e.log=function(){a.login(e.username,e.password,function(e){o.path("/dashboard"),console.log(e)},function(e){alert("Something went wrong with the login process. Try again later!"),console.log(e)})},e.username="abel",e.password="pass",a.checkIfLoggedIn()&&o.path("/");const l=new TimelineMax({paused:!0,completed:!0});l.from(".bg",1.7,{x:"100%",ease:Expo.easeOut},0),l.from(".row",1.7,{x:"100%",opacity:0,ease:Expo.easeOut},.2),l.restart()}]),angular.module("elycee").controller("MainCtrl",function(e,t,o){t.get("api/articles").success(function(t){e.posts=t}),e.val=function(){o.id=this.post.id},e.sizeOf=function(e){var t=Object.keys(e||{}).length;return 0===t||1===t?t+" commentaire":t+" commentaires"},e.show=function(){$(".col_left .row").html('<div class="el" style="background-image:url(\'/uploads/images/'+this.post.url_thumbnail+"')\"></div>"),$("#home-page .big-title h1").html(this.post.title),TweenLite.from("#home-page .big-title h1",1,{opacity:0,y:"100%",ease:Expo.easeOut}),TweenLite.to("#home-page .big-title h1",1,{opacity:1,y:"0%",ease:Expo.easeOut}),TweenLite.from(".col_left .row",1,{opacity:0,scale:1.1,ease:Expo.easeOut}),TweenLite.to(".col_left .row",1,{opacity:1,scale:1,ease:Expo.easeOut}),TweenLite.to(".col_left .new",1,{opacity:0,scale:1,ease:Expo.easeOut})},e.hide=function(){TweenLite.to(".col_left .row",1,{opacity:0,scale:1.1,ease:Expo.easeOut}),TweenLite.to("#home-page .big-title h1",1,{opacity:0,y:"100%",ease:Quart.easeOut}),TweenLite.from(".col_left .new",1,{opacity:0,scale:1.1,ease:Expo.easeOut}),TweenLite.to(".col_left .new",1,{opacity:1,scale:1,ease:Expo.easeOut})};const a=new TimelineMax({paused:!0,completed:!0});a.to(".col_right",1.7,{right:"0%",ease:Expo.easeOut},0),a.from(".info",1,{opacity:0,x:"10%",ease:Expo.easeOut},1.8),a.to(".col_right footer",1,{opacity:1},1.9),a.from(".row",1,{opacity:0,x:"10%",ease:Expo.easeOut},2),a.from(".col_left .new",1.7,{opacity:0,scale:1.2},2.2),a.from(".col_left h1",1,{opacity:0,x:"-10%",ease:Expo.easeOut},3.8),a.from(".col_left .mask",1,{opacity:0,x:"-10%",ease:Expo.easeOut},4),a.restart()}),angular.module("elycee").controller("SearchCtrl",function(e,t,o,a){t.submitSearch=function(){a.search=t.searchText,o.path("/actus")};const l=new TimelineMax({paused:!0,completed:!0});l.from(".bg",1.7,{x:"100%",ease:Expo.easeOut},0),l.from(".row",1.7,{x:"100%",opacity:0,ease:Expo.easeOut},.2),l.restart()}),angular.module("elycee").controller("SingleCtrl",function(e,t,o,a,l){var n=o.id;t.get("api/articles/"+n).success(function(t){e.post=t[0],e.comments=t[0].comment}),e.submitComment=function(){a.save(e.commentText,n,1,e.titleText).success(function(o){t.get("api/articles/"+n).success(function(t){e.comments=t[0].comment,e.commentText="",e.titleText=""})}).error(function(e){console.log("error ")})};const c=new TimelineMax({paused:!0,completed:!0});c.to(".col_right",1.7,{right:"0%",ease:Expo.easeOut},0),c.staggerFrom(".cat",1,{opacity:0,x:"10%",ease:Expo.easeOut},.2,2),c.from(".col_left .solo",1.7,{opacity:0,scale:1.2},2.2),c.to(".col_left .solo",1.7,{opacity:1,scale:1},2.2),c.from(".col_left h1",1,{opacity:0,x:"-10%",ease:Expo.easeOut},3.8),c.from(".col_left .mask",1,{opacity:0,x:"-10%",ease:Expo.easeOut},4),c.restart()});